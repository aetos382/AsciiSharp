# language: ja

@T114
フィーチャ: コメント解析
    ライブラリユーザーとして、
    AsciiDoc のコメントを正しく解析し、
    ラウンドトリップが可能な構文木を取得したい

    背景:
        前提 AsciiDoc パーサーが初期化されている

    シナリオ: 単一行コメントを含む文書の解析
        前提 以下の AsciiDoc 文書がある:
            """
            = タイトル

            // これはコメント
            本文テキスト
            """
        もし 文書を解析する
        かつ 構文木から完全なテキストを取得する
        ならば 解析は成功する
        かつ 再構築されたテキストは元の文書と一致する
        かつ Document ノードは 1 個の段落を持つ
        かつ 段落のテキストは "// これはコメント" を含まない
        かつ 構文木に "これはコメント" を含むコメントがある
        かつ 構文木に 1 個の単一行コメントがある

    シナリオ: ブロックコメントを含む文書の解析
        前提 以下の AsciiDoc 文書がある:
            """
            = タイトル

            ////
            ブロック
            コメント
            ////
            本文テキスト
            """
        もし 文書を解析する
        かつ 構文木から完全なテキストを取得する
        ならば 解析は成功する
        かつ 再構築されたテキストは元の文書と一致する
        かつ Document ノードは 1 個の段落を持つ
        かつ 構文木に "ブロック" を含むコメントがある
        かつ 構文木に "コメント" を含むコメントがある
        かつ 構文木に 1 個のブロックコメントがある

    シナリオ: URL 内の // はコメントとして扱わない
        前提 以下の AsciiDoc 文書がある:
            """
            https://example.com/path
            """
        もし 文書を解析する
        ならば 解析は成功する
        かつ Link ノードのターゲット URL は "https://example.com/path" である

    シナリオ: セクション内の単一行コメント
        前提 以下の AsciiDoc 文書がある:
            """
            = タイトル

            == セクション 1
            // セクション内コメント
            段落テキスト

            == セクション 2
            別の段落
            """
        もし 文書を解析する
        かつ 構文木から完全なテキストを取得する
        ならば 解析は成功する
        かつ 再構築されたテキストは元の文書と一致する
        かつ Document ノードは 2 個のセクションを持つ
        かつ 構文木に "セクション内コメント" を含むコメントがある
        かつ 構文木に 1 個の単一行コメントがある

    シナリオ: 冒頭に単一行コメントがある文書の解析
        前提 以下の AsciiDoc 文書がある:
            """
            // 冒頭のコメント
            = タイトル

            本文テキスト
            """
        もし 文書を解析する
        かつ 構文木から完全なテキストを取得する
        ならば 解析は成功する
        かつ 再構築されたテキストは元の文書と一致する
        かつ Document ノードはタイトル "タイトル" を持つ
        かつ Document ノードは 1 個の段落を持つ
        かつ 構文木のトリビアに "// 冒頭のコメント" が含まれる
        かつ 構文木に "冒頭のコメント" を含むコメントがある
        かつ 構文木に 1 個の単一行コメントがある

    シナリオ: 冒頭にブロックコメントがある文書の解析
        前提 以下の AsciiDoc 文書がある:
            """
            ////
            冒頭の
            ブロックコメント
            ////
            = タイトル

            本文テキスト
            """
        もし 文書を解析する
        かつ 構文木から完全なテキストを取得する
        ならば 解析は成功する
        かつ 再構築されたテキストは元の文書と一致する
        かつ Document ノードはタイトル "タイトル" を持つ
        かつ Document ノードは 1 個の段落を持つ
        かつ 構文木のトリビアに "冒頭の" が含まれる
        かつ 構文木に "ブロックコメント" を含むコメントがある
        かつ 構文木に 1 個のブロックコメントがある

    シナリオ: 冒頭に複数のコメントがある文書の解析
        前提 以下の AsciiDoc 文書がある:
            """
            // 最初のコメント
            // 2番目のコメント
            = タイトル

            本文テキスト
            """
        もし 文書を解析する
        かつ 構文木から完全なテキストを取得する
        ならば 解析は成功する
        かつ 再構築されたテキストは元の文書と一致する
        かつ Document ノードはタイトル "タイトル" を持つ
        かつ Document ノードは 1 個の段落を持つ
        かつ 構文木のトリビアに "// 最初のコメント" が含まれる
        かつ 構文木のトリビアに "// 2番目のコメント" が含まれる
        かつ 構文木に "最初のコメント" を含むコメントがある
        かつ 構文木に "2番目のコメント" を含むコメントがある
        かつ 構文木に 2 個の単一行コメントがある
